(function(e){function t(t){for(var n,o,i=t[0],s=t[1],u=t[2],d=0,f=[];d<i.length;d++)o=i[d],c[o]&&f.push(c[o][0]),c[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);l&&l(t);while(f.length)f.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,o=1;o<r.length;o++){var i=r[o];0!==c[i]&&(n=!1)}n&&(a.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},o={app:0},c={app:0},a=[];function i(e){return s.p+"js/"+({about:"about",preferences:"preferences",projectstack:"projectstack",projects:"projects"}[e]||e)+"."+{about:"a8ededa8",preferences:"7b1d513f",projectstack:"92ad3143",projects:"7b2b354b"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r={preferences:1,projectstack:1,projects:1};o[e]?t.push(o[e]):0!==o[e]&&r[e]&&t.push(o[e]=new Promise(function(t,r){for(var n="css/"+({about:"about",preferences:"preferences",projectstack:"projectstack",projects:"projects"}[e]||e)+"."+{about:"31d6cfe0",preferences:"e4cd6812",projectstack:"ce42149f",projects:"fa6c01bc"}[e]+".css",c=s.p+n,a=document.getElementsByTagName("link"),i=0;i<a.length;i++){var u=a[i],d=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(d===n||d===c))return t()}var f=document.getElementsByTagName("style");for(i=0;i<f.length;i++){u=f[i],d=u.getAttribute("data-href");if(d===n||d===c)return t()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=t,l.onerror=function(t){var n=t&&t.target&&t.target.src||c,a=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=n,delete o[e],l.parentNode.removeChild(l),r(a)},l.href=c;var p=document.getElementsByTagName("head")[0];p.appendChild(l)}).then(function(){o[e]=0}));var n=c[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise(function(t,r){n=c[e]=[t,r]});t.push(n[2]=a);var u,d=document.createElement("script");d.charset="utf-8",d.timeout=120,s.nc&&d.setAttribute("nonce",s.nc),d.src=i(e),u=function(t){d.onerror=d.onload=null,clearTimeout(f);var r=c[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src,a=new Error("Loading chunk "+e+" failed.\n("+n+": "+o+")");a.type=n,a.request=o,r[1](a)}c[e]=void 0}};var f=setTimeout(function(){u({type:"timeout",target:d})},12e4);d.onerror=d.onload=u,document.head.appendChild(d)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],d=u.push.bind(u);u.push=t,u=u.slice();for(var f=0;f<u.length;f++)t(u[f]);var l=d;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var n=r("64a9"),o=r.n(n);o.a},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("b-alert",{attrs:{show:e.isConnectionProblem,variant:"warning"}},[r("h4",[e._v("Connection Problem")]),r("p",[e._v("It seems that Gearbox Server is not running. Remaining connection attempts: "+e._s(e.remainingRetries))])]),e.isUnrecoverableConnectionProblem?r("b-alert",{attrs:{show:"",variant:"danger"}},[r("h4",[e._v("Connection Problem")]),r("p",[e._v("Failed to connect to Gearbox Server.")])]):e._e(),r("top-bar"),r("router-view")],1)},c=[],a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"secondary"}},[r("b-navbar-brand",{attrs:{to:"/projects"}},[e._v("Gearbox")]),r("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),r("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[r("b-navbar-nav",[r("b-nav-item",{attrs:{to:"/projects"}},[e._v("Projects")])],1),r("b-navbar-nav",{staticClass:"ml-auto"},[r("b-nav-item",{attrs:{right:"",to:"/preferences"}},[r("font-awesome-icon",{attrs:{title:"Preferences",icon:["fa","cog"]}})],1)],1)],1)],1)],1)},i=[],s={name:"TopBar.vue"},u=s,d=r("2877"),f=Object(d["a"])(u,a,i,!1,null,"299d1b8b",null),l=f.exports,p={name:"App",components:{TopBar:l},computed:{isConnectionProblem:function(){return this.$store.state.connectionStatus.networkError&&this.$store.state.connectionStatus.remainingRetries>0},remainingRetries:function(){return this.$store.state.connectionStatus.remainingRetries},isUnrecoverableConnectionProblem:function(){return this.$store.state.connectionStatus.networkError?0===this.$store.state.connectionStatus.remainingRetries:""}}},v=p,m=(r("034f"),Object(d["a"])(v,o,c,!1,null,null,null)),b=m.exports,h=r("8c4f"),g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h1",[e._v("Welcome to Gearbox")])},E=[],j={},_=Object(d["a"])(j,g,E,!1,null,null,null),T=_.exports;n["default"].use(h["a"]);var S=new h["a"]({routes:[{path:"/",name:"welcome",component:T},{path:"/about",name:"about",component:function(){return r.e("about").then(r.bind(null,"f820"))}},{path:"/preferences",name:"preferences",component:function(){return r.e("preferences").then(r.bind(null,"a55d"))}},{path:"/projects",name:"projects",component:function(){return Promise.all([r.e("projectstack"),r.e("projects")]).then(r.bind(null,"acca"))},children:[{path:":hostname/stack",component:function(){return r.e("projectstack").then(r.bind(null,"2232"))}}]}]}),O=(r("a481"),r("7f7f"),r("ac6a"),r("6762"),r("2fdb"),r("55dd"),r("28a5"),r("7514"),r("cebc")),P=r("2f62"),R=r("bc3a"),k=r.n(R),y=r("a7fe"),C=r.n(y),A=r("6916"),w=k.a.create({baseURL:"http://127.0.0.1:9999/",crossDomain:!0,headers:{"Content-Type":"application/vnd.api+json"}}),I=w,x=r("a592");n["default"].use(P["a"]),n["default"].use(C.a,k.a);var B=new P["a"].Store({strict:!0,modules:Object(O["a"])({},Object(x["a"])({names:["stacks","services","gearspecs","projects","basedirs"],httpClient:I})),state:{stacks:[],removedStacks:{},services:[],gearspecs:[],projects:[],basedirs:[],connectionStatus:{networkError:null,remainingRetries:5},showProjectsHaving:{states:["running","stopped","candidates"],basedir:"all",stacks:"all",programs:"all"}},getters:{basedirBy:function(e){return function(t,r){return"id"===t?e.basedirs.records.find(function(e){return e.id===r}):e.basedirs.records.find(function(e){return e.attributes[t]===r})}},stackBy:function(e){return function(t,r){return"id"===t?e.stacks.records.find(function(e){return e.id===r}):e.stacks.records.find(function(e){return e.attributes[t]===r})}},serviceBy:function(e){return function(t,r){return"id"===t?e.services.records.find(function(e){return e.id===r}):e.services.records.find(function(e){return e.attributes[t]===r})}},gearspecBy:function(e){return function(t,r){return"id"===t?e.gearspecs.records.find(function(e){return e.id===r}):e.gearspecs.records.find(function(e){return e.attributes[t]===r})}},projectBy:function(e){return function(t,r){return"id"===t?e.projects.records.find(function(e){return e.id===r}):e.projects.records.find(function(e){return e.attributes[t]===r})}},filterProjectsBy:function(e){return function(t,r){var n=["basedir","enabled","filepath","hostname","path","project_dir"],o=Array.isArray(r)?r:[r],c=[];return"id"===t?c=e.projects.records.filter(function(e){return-1!==o.indexOf(e.id)}):-1!==n.indexOf(t)?c=e.projects.records.filter(function(e){return-1!==o.indexOf(e.attributes[t])}):"stacks"===t?c=e.projects.records.filter(function(e){return e.attributes.stack.some(function(e){return o.some(function(t){return e.gearspec_id.indexOf(t)>-1})})}):"programs"===t&&(c=e.projects.records.filter(function(e){return e.attributes.stack.some(function(e){return o.some(function(t){return e.service_id.split("/")[1].split(":")[0]===t})})})),c}},filteredProjects:function(e,t){var r=e.projects.records,n=function(n){var o=e.showProjectsHaving[n];return"all"===o?"continue":"states"===n?3===o.length?"continue":(o.indexOf("running")>-1&&(r=r.filter(function(e){return t.filterProjectsBy("enabled",!0).includes(e)})),o.indexOf("stopped")>-1&&(r=r.filter(function(e){return t.filterProjectsBy("enabled",!1).includes(e)})),"continue"):void(r=r.filter(function(e){return t.filterProjectsBy(n,o).includes(e)}))};for(var o in e.showProjectsHaving)n(o);return r.concat().sort(function(e,t){return e.id>t.id?1:e.id===t.id?0:-1})},projectStackItemIndexBy:function(e){return function(e,t,r){var n=-1;return e.attributes.stack.find(function(e,o){return e[t]===r&&(n=o,!0)}),n}},stackDefaultServiceByRole:function(e){return function(e,t){var r="";return e.attributes.members.find(function(e,n){return e.gearspec_id===t&&(r=e.default_service,!0)}),r}},stackServicesByRole:function(e){return function(e,t){var r=[];return e.attributes.members.find(function(e,n){return e.gearspec_id===t&&(r=e.services,!0)}),r}},stacksAsOptions:function(e){var t=[];return e.stacks.records.forEach(function(e,r){t.push({value:e.id,text:e.attributes.stackname})}),t.sort(function(e,t){return e.value>t.value?1:e.value===t.value?0:-1})},servicesAsOptions:function(e){var t=[];return e.services.records.forEach(function(e,r){t.push({value:e.id,text:e.id})}),t},programsAsOptions:function(e){var t=[],r=[];return e.services.records.forEach(function(e,n){var o=e.attributes.program;-1===t.indexOf(o)&&(t.push(o),r.push({value:o,text:o}))}),r.sort(function(e,t){return e.value>t.value?1:e.value===t.value?0:-1})},basedirsAsOptions:function(e){var t=[];return e.basedirs.records.forEach(function(e,r){t.push({value:e.id,text:e.attributes.basedir})}),t.sort(function(e,t){return e.value>t.value?1:e.value===t.value?0:-1})},hasExtraBasedirs:function(e){return e.basedirs.records.length>1},preselectServiceId:function(e){return function(e,t,r){var n=-1,o=-1,c=r||t;if(c)do{for(var a=e.length;a--;)if(-1!==e[a].indexOf(c)&&(-1===n&&(n=a),e[a]===c)){o=a;break}if(-1===n){var i=c.split(".");if(!(i.length>1))break;delete i[i.length-1],c=i.join("."),c=c.substring(0,c.length-1)}}while(-1===n);var s=-1!==n?e[-1!==o?o:n]:"";return s}}},actions:{loadProjectDetails:function(e){var t=e.commit;for(var r in this.state.projects.records){var n=this.state.projects.records[r];try{I.get("projects/"+n.id,{crossDomain:!0,raxConfig:{onRetryAttempt:function(e){var r=Object(A["getConfig"])(e);t("SET_NETWORK_ERROR",e.message),t("SET_REMAINING_RETRIES",r.retry-r.currentRetryAttempt)}}}).catch(function(e,t){console.log("rejected",e)}).then(function(e){return e?e.data:null}).then(function(e){var r=e.data;if(setTimeout(function(){t("SET_PROJECT",r)},1e3),e.included.length)for(var n in e.included){var o=e.included[n];"service"===o.type&&t("SET_SERVICE",o),"stack"===o.type&&t("SET_STACK",o)}})}catch(o){console.log(o)}}},updateProject:function(e,t){var r=e.commit,n=t.hostname,o=t.project;r("UPDATE_PROJECT",{hostname:n,project:o}),I({method:"post",url:"project/"+n,data:o}).then(function(e){return e.data}).then(function(e){}).catch(function(e){console.log("rejected",e)})},addBaseDir:function(e,t){var r=e.commit,n=t.name,o=t.path;r("ADD_BASEDIR",{value:n,text:o}),I({method:"post",url:"basedirs/new",data:t}).then(function(e){return e.data}).then(function(e){}).catch(function(e){console.log("rejected",e)})},addProjectStack:function(e,t){var r=e.commit;return console.log("TODO: call API method to add project stack"),new Promise(function(e,n){setTimeout(function(){r("ADD_PROJECT_STACK",t),e()},2e3)})},removeProjectStack:function(e,t){var r=e.commit;r("REMOVE_PROJECT_STACK",t)},addProjectNote:function(e,t){var r=e.commit;return console.log("TODO: call API method to add a note to the project"),new Promise(function(e,n){setTimeout(function(){r("ADD_PROJECT_NOTE",t),e()},2e3)})},updateProjectHostname:function(e,t){var r=e.commit;return console.log("TODO: call API method to update project hostname"),new Promise(function(e,n){setTimeout(function(){r("UPDATE_PROJECT_HOSTNAME",t),e()},2e3)})},changeProjectService:function(e,t){var r=e.commit;setTimeout(function(){return r("CHANGE_PROJECT_SERVICE",t)},1e3)},changeProjectState:function(e,t){var r=e.commit;return console.log("TODO: call the API to change project state"),new Promise(function(e,n){setTimeout(function(){r("CHANGE_PROJECT_STATE",t),e()},2e3)})},setProjectsFilter:function(e,t){var r=e.commit;r("SET_PROJECTS_FILTER",t)},getDirectory:function(e,t){e.commit;return I.head("directories/"+encodeURI(t.dir))}},mutations:{SET_PROJECT:function(e,t){var r=this.getters.projectBy("id",t.id);r?n["default"].set(r.attributes,"stack",t.attributes.stack):e.projects.records.push(t)},SET_STACK:function(e,t){var r=this.getters.stackBy("id",t.id);r?r.attributes=t.attributes:e.stacks.records.push(t)},SET_SERVICE:function(e,t){var r=this.getters.serviceBy("id",t.id);r?r.attributes=t.attributes:e.services.records.push(t)},SET_GEARSPEC:function(e,t){var r=this.getters.gearspecBy("id",t.id);r?r.attributes=t.attributes:e.gearspecs.records.push(t)},SET_NETWORK_ERROR:function(e,t){e.connectionStatus.networkError=t},CLEAR_NETWORK_ERROR:function(e){e.connectionStatus.networkError=""},SET_REMAINING_RETRIES:function(e,t){e.connectionStatus.remainingRetries=t},ADD_BASEDIR:function(e,t){e.baseDirs[t.value]=t},ADD_PROJECT_STACK:function(e,t){var r=this,o=t.projectId,c=t.stackId,a=c.replace("(removed)",""),i=this.getters.projectBy("id",o),s=this.getters.stackBy("id",a);i&&s&&s.attributes.members.length&&("undefined"===typeof i.attributes.stack&&n["default"].set(i.attributes,"stack",[]),s.attributes.members.forEach(function(e,t){if(e.gearspec_id){var o=i.attributes.stack.find(function(t){return t.gearspec_id===e.gearspec_id});if(o&&c!==a)n["default"].set(o,"isRemoved",!1);else{var s=r.getters.preselectServiceId(e.services,e.default_service);o?(n["default"].set(o,"isRemoved",!1),n["default"].set(o,"service_id",s)):i.attributes.stack.push({service_id:s,gearspec_id:e.gearspec_id,isRemoved:!1})}}}))},REMOVE_PROJECT_STACK:function(e,t){var r=t.projectId,o=t.stackId,c=this.getters.projectBy("id",r);if(c)for(var a=o.split("/")[1],i=c.attributes.stack.length-1;i>=0;i--)c.attributes.stack[i].gearspec_id.split("/")[1]===a&&n["default"].set(c.attributes.stack[i],"isRemoved",!0)},CHANGE_PROJECT_SERVICE:function(e,t){var r=t.projectId,o=t.gearspecId,c=t.serviceId,a=this.getters.projectBy("id",r);if(a){var i=this.getters.projectStackItemIndexBy(a,"gearspec_id",o);n["default"].set(a.attributes.stack[i],"service_id",c)}},CHANGE_PROJECT_STATE:function(e,t){var r=t.projectId,n=t.isEnabled,o=this.getters.projectBy("id",r);o&&(o.attributes.enabled=!!n)},SET_PROJECTS_FILTER:function(e,t){var r=t.field,o=t.values;n["default"].set(e.showProjectsHaving,r,o)},ADD_PROJECT_NOTE:function(e,t){},UPDATE_PROJECT_HOSTNAME:function(e,t){}}}),D=r("9f7b");r("f9e3"),r("2dd8");n["default"].use(D["a"]);var N=r("ecee"),J=r("c074"),H=r("ad3d");N["c"].add(J["s"]),N["c"].add(J["y"]),N["c"].add(J["a"]),N["c"].add(J["z"]),N["c"].add(J["q"]),N["c"].add(J["i"]),N["c"].add(J["n"]),N["c"].add(J["f"]),N["c"].add(J["e"]),N["c"].add(J["c"]),N["c"].add(J["d"]),N["c"].add(J["l"]),N["c"].add(J["m"]),N["c"].add(J["k"]),N["c"].add(J["o"]),N["c"].add(J["p"]),N["c"].add(J["C"]),N["c"].add(J["b"]),N["c"].add(J["t"]),N["c"].add(J["j"]),N["c"].add(J["A"]),N["c"].add(J["w"]),N["c"].add(J["v"]),N["c"].add(J["x"]),N["c"].add(J["r"]),N["c"].add(J["h"]),N["c"].add(J["B"]),N["c"].add(J["u"]),N["c"].add(J["g"]),n["default"].component("font-awesome-icon",H["a"]),n["default"].config.productionTip=!1,new n["default"]({router:S,store:B,render:function(e){return e(b)}}).$mount("#app")},"64a9":function(e,t,r){}});
//# sourceMappingURL=app.8237fbaa.js.map