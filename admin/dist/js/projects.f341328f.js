(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["projects"],{"0baa":function(t,e,r){"use strict";const o=r("df7c"),a=r("4845"),s=r("d40f"),i=r("6d1c"),n=100,c=/[\u0000-\u001f\u0080-\u009f]/g,l=/^\.+/,u=(t,e={})=>{if("string"!==typeof t)throw new TypeError("Expected a string");const r=void 0===e.replacement?"!":e.replacement;if(s().test(r)&&c.test(r))throw new Error("Replacement string cannot contain reserved filename characters");return t=t.replace(s(),r),t=t.replace(c,r),t=t.replace(l,r),r.length>0&&(t=a(t,r),t=t.length>1?i(t,r):t),t=s.windowsNames().test(t)?t+r:t,t=t.slice(0,n),t};u.path=((t,e)=>{return t=o.resolve(t),o.join(o.dirname(t),u(o.basename(t),e))}),t.exports=u},"2d1f":function(t,e,r){t.exports=r("b606")},4845:function(t,e,r){"use strict";var o=r("a318");t.exports=function(t,e){if("string"!==typeof t||"string"!==typeof e)throw new TypeError("Expected a string");return t.replace(new RegExp("(?:"+o(e)+"){2,}","g"),e)}},"4da3":function(t,e,r){"use strict";var o=r("c61f"),a=r.n(o);a.a},"64f2":function(t,e,r){"use strict";var o=r("f494"),a=r.n(o);a.a},"6d1c":function(t,e,r){"use strict";var o=r("a318");t.exports=function(t,e){if("string"!==typeof t||"string"!==typeof e)throw new TypeError;return e=o(e),t.replace(new RegExp("^"+e+"|"+e+"$","g"),"")}},7579:function(t,e,r){"use strict";var o=r("8bf0"),a=r.n(o);a.a},"8bf0":function(t,e,r){},"9c60":function(t,e,r){var o=r("63b6"),a=r("13c8")(!0);o(o.S,"Object",{entries:function(t){return a(t)}})},a318:function(t,e,r){"use strict";var o=/[|\\{}()[\]^$+*?.]/g;t.exports=function(t){if("string"!==typeof t)throw new TypeError("Expected a string");return t.replace(o,"\\$&")}},acca:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-container",[r("b-card-group",{attrs:{deck:""}},t._l(t.projects,function(t,e){return r("project-card",{key:t.id,attrs:{project:t,projectIndex:e}})}),1)],1)},a=[],s=r("cebc"),i=r("2f62"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-card",{class:{"card--project":!0,"showing-details":t.showingDetails,"not-showing-details":!t.showingDetails},attrs:{to:{path:"/project/"+t.id}}},[r("b-form",[r("b-form-group",{staticClass:"hostname-group",attrs:{id:"hostname-group-"+t.projectIndex,label:"","label-for":"hostname-input-"+t.projectIndex,description:t.showingDetails?"Hostname":""}},[r("b-form-input",{staticClass:"hostname-input",attrs:{id:"hostname-input-"+t.projectIndex,type:"text",size:"lg",required:"",placeholder:""},on:{change:t.maybeSubmit,click:function(e){t.showingDetails=!0}},model:{value:t.hostname,callback:function(e){t.hostname=e},expression:"hostname"}})],1),r("project-toolbar",{attrs:{project:t.project,projectIndex:t.projectIndex}}),t.showingDetails?r("project-details",{attrs:{project:t.project,projectIndex:t.projectIndex},on:{"toggle-details":t.toggleDetails}}):t._e(),r("a",{staticClass:"show-details",attrs:{title:"Show project details"},on:{click:function(e){t.showingDetails=!0}}},[r("font-awesome-icon",{attrs:{icon:["fa","ellipsis-h"]}})],1)],1),t.project.attributes.stack&&t.project.attributes.stack.length?r("div",{attrs:{slot:"footer"},slot:"footer"},[r("project-stack",{attrs:{project:t.project,projectIndex:t.projectIndex}})],1):t._e()],1)},c=[],l=(r("a481"),r("c5f6"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"toolbar-list"},[r("li",{staticClass:"toolbar-item"},[r("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],class:["toolbar-link","toolbar-link--frontend",{"is-disabled":!t.isRunning}],attrs:{target:"_blank",href:"//"+t.hostname+"/",title:"Open Frontend"+(t.isRunning?"":" (not running)")}},[r("font-awesome-icon",{attrs:{icon:["fa","home"]}})],1)]),r("li",{staticClass:"toolbar-item"},[r("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],class:["toolbar-link","toolbar-link--dashboard",{"is-disabled":!t.isRunning}],attrs:{target:"_blank",href:"//"+t.hostname+"/wp-admin/",title:"Open Dashboard"+(t.isRunning?"":" (not running)")}},[r("font-awesome-icon",{attrs:{icon:["fa","tachometer-alt"]}})],1)]),r("li",{staticClass:"toolbar-item"},[r("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"toolbar-link toolbar-link--state",attrs:{target:"_blank",href:"#",title:t.isRunning?"Stop all services":"Run all services"},on:{click:function(e){return e.preventDefault(),t.onRunStop(e)}}},[r("font-awesome-icon",{attrs:{icon:["fa",t.isRunning?"stop-circle":"play-circle"]}})],1)])])}),u=[],p={name:"ProjectToolbar",props:{project:{type:Object,required:!0},projectIndex:{type:Number,required:!0}},data:function(){return{id:this.project.id,hostname:this.project.attributes.hostname}},computed:{projectBase:function(){return this.escAttr(this.id)+"-"},isRunning:function(){return this.project.attributes.enabled}},methods:{escAttr:function(t){return t.replace(/\//g,"-").replace(/\./g,"-")},onRunStop:function(){console.log("onRunStop"),this.$store.dispatch("changeProjectState",{projectId:this.id,isEnabled:!this.isRunning})}}},d=p,h=(r("c4a8"),r("2877")),f=Object(h["a"])(d,l,u,!1,null,"37b5962c",null),b=f.exports,m=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:t.projectBase+"details",role:"tabpanel"}},[r("b-form-group",{attrs:{id:t.projectBase+"location-group","label-for":t.projectBase+"location-input",label:"",description:"Location"}},[r("b-form-input",{staticClass:"location-input",attrs:{disabled:"",id:t.projectBase+"location-input",value:t.resolveDir(t.currentBasedir,t.path)}}),r("a",{class:["cog-icon"],attrs:{target:"_blank",id:t.projectBase+"change-location",href:"#",title:"Change location"},on:{click:function(t){t.preventDefault()}}},[r("font-awesome-icon",{attrs:{icon:["fa","cog"]}})],1)],1),r("b-popover",{ref:t.projectBase+"location-popover",attrs:{target:t.projectBase+"change-location",container:t.projectBase+"details",triggers:"focus",placement:"bottom"}},[r("template",{slot:"title"},[r("b-button",{staticClass:"close",attrs:{"aria-label":"Close"},on:{click:function(e){return t.onClosePopoverFor(t.projectBase+"change-location")}}},[r("span",{staticClass:"d-inline-block",attrs:{"aria-hidden":"true"}},[t._v("Ã—")])]),t._v("\n      Change location\n    ")],1),r("b-form-group",{attrs:{label:"Base directory:","label-for":"basedirInput",description:"Go to Preferences page to add more directories."}},[Object.entries(this.$store.getters.baseDirsAsOptions).length>1?r("b-form-select",{attrs:{required:"",options:this.$store.getters.baseDirsAsOptions},on:{change:t.maybeSubmit},model:{value:t.basedir,callback:function(e){t.basedir=e},expression:"basedir"}}):r("b-form-input",{attrs:{required:"",disabled:"",value:t.currentBasedir},on:{change:t.maybeSubmit}})],1),r("b-form-group",{attrs:{label:"Path:","label-for":"dirNameInput",description:""}},[r("b-form-input",{attrs:{type:"text",required:"",placeholder:""},on:{input:function(e){t.path=t.sanitizePath(t.path)},change:t.maybeSubmit},model:{value:t.path,callback:function(e){t.path=e},expression:"path"}})],1)],2),r("b-form-group",{attrs:{id:"notesGroup",label:"","label-for":"notesInput",description:"(will be visible only here)"}},[r("b-form-textarea",{attrs:{id:"textarea",placeholder:"Notes...",rows:"3","max-rows":"6"},on:{change:t.maybeSubmit},model:{value:t.notes,callback:function(e){t.notes=e},expression:"notes"}})],1),r("b-form-select",{staticClass:"add-stack",attrs:{disabled:!t.hasStacksNotInProject,required:!0},on:{change:t.addProjectStack},model:{value:t.selectedService,callback:function(e){t.selectedService=e},expression:"selectedService"}},[r("option",{attrs:{value:"",disabled:""}},[t._v(t._s(t.hasStacksNotInProject?"Add stack...":"All stacks already added"))]),t._l(t.stacksNotInProject,function(e,o){return r("option",{key:o,domProps:{value:o}},[t._v(t._s(e.attributes.stackname))])})],2),r("a",{staticClass:"hide-details",attrs:{title:"Hide project details"},on:{click:function(e){return t.$emit("toggle-details")}}},[r("font-awesome-icon",{attrs:{icon:["fa","chevron-up"]}}),r("span",[t._v("Hide")])],1)],1)},g=[],j=(r("ac6a"),r("2d1f")),v=r.n(j),k=r("0baa"),w=r.n(k),y={name:"ProjectDetails",props:{project:{type:Object,required:!0},projectIndex:{type:Number,required:!0}},data:function(){return Object(s["a"])({id:this.project.id},this.project.attributes,{selectedService:""})},computed:Object(s["a"])({},Object(i["b"])({basedirBy:"basedirBy",serviceBy:"serviceBy",gearBy:"gearBy",allGearspecs:"gearspecs/all",allStacks:"stacks/all"}),{projectBase:function(){return this.escAttr(this.id)+"-"},currentBasedir:function(){var t=this.basedirBy("id",this.basedir);return t?t.attributes.basedir:""},stacksNotInProject:function(){var t={},e=this.project.attributes.stack?this.groupProjectServicesByStack(this.project.attributes.stack):{};for(var r in this.allStacks){var o=this.allStacks[r];"undefined"===typeof e[o.id]&&(t[o.id]=o)}return t},hasStacksNotInProject:function(){return v()(this.stacksNotInProject).length>0},servicesInProject:function(){for(var t={},e=0;e>this.stack.length;e++){var r=this.serviceBy("id",this.stack[e].service_id);r&&(t[this.stack[e].service_id]=r)}return t},gearsInProject:function(){for(var t={},e=0;e>this.stack.length;e++){var r=this.gearBy("id",this.stack[e].gearspec_id);r&&(t[this.stack[e].gearspec_id]=r)}return t}}),methods:{escAttr:function(t){return t.replace(/\//g,"-").replace(/\./g,"-")},groupProjectServicesByStack:function(t){var e=this,r={};return t.forEach(function(t,o){var a=e.gearBy("id",t.gearspec_id),s=e.serviceBy("id",t.service_id);a&&s&&("undefined"===typeof r[a.attributes.stack_id]&&(r[a.attributes.stack_id]={}),r[a.attributes.stack_id][a.attributes.role]=s)}),r},resolveDir:function(t,e){return t+(-1!==t.indexOf("/")?"/":"\\")+e},maybeSubmit:function(t){this.$store.dispatch("updateProject",{id:this.id,attributes:this.$data}).then(function(){})},onClosePopoverFor:function(t){this.$root.$emit("bv::hide::popover",t)},addProjectStack:function(t){this.selectedService="",this.$store.dispatch("addProjectStack",{projectId:this.id,stackId:t})},sanitizePath:function(t){var e=w()(t).trim();return e||"project"}}},x=y,S=(r("7579"),Object(h["a"])(x,m,g,!1,null,"2a3fe422",null)),P=S.exports,_=r("3983"),B={name:"ProjectCard",props:{project:{type:Object,required:!0},projectIndex:{type:Number,required:!0}},data:function(){return Object(s["a"])({id:this.project.id},this.project.attributes,{showingDetails:!1})},components:{ProjectToolbar:b,ProjectDetails:P,ProjectStack:_["default"]},computed:{projectBase:function(){return this.escAttr(this.id)+"-"}},methods:{escAttr:function(t){return t.replace(/\//g,"-").replace(/\./g,"-")},toggleDetails:function(){this.showingDetails=!this.showingDetails},maybeSubmit:function(t){this.$store.dispatch("updateProject",{id:this.id,attributes:this.$data}).then(function(){})}}},I=B,$=(r("64f2"),Object(h["a"])(I,n,c,!1,null,"1f07f3bd",null)),D=$.exports,O={name:"ProjectList",components:{ProjectCard:D},computed:Object(s["a"])({},Object(i["b"])({projects:"projects/all"})),mounted:function(){var t=this;this.$store.dispatch("basedirs/loadAll").then(function(){}),this.$store.dispatch("stacks/loadAll").then(function(){}),this.$store.dispatch("services/loadAll").then(function(){}),this.$store.dispatch("gearspecs/loadAll").then(function(){}),this.$store.dispatch("projects/loadAll").then(function(){}).then(function(){t.$store.dispatch("loadProjectDetails")})}},C=O,E=(r("4da3"),Object(h["a"])(C,o,a,!1,null,"6a2e6a6b",null));e["default"]=E.exports},b606:function(t,e,r){r("9c60"),t.exports=r("584a").Object.entries},c4a8:function(t,e,r){"use strict";var o=r("d7b1"),a=r.n(o);a.a},c61f:function(t,e,r){},d40f:function(t,e,r){"use strict";t.exports=(()=>/[<>:"\/\\|?*\x00-\x1F]/g),t.exports.windowsNames=(()=>/^(con|prn|aux|nul|com[0-9]|lpt[0-9])$/i)},d7b1:function(t,e,r){},f494:function(t,e,r){}}]);
//# sourceMappingURL=projects.f341328f.js.map